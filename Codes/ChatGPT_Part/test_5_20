def answer(query, text):
    model = "gpt-3.5-turbo"
    query = query + "\n대화 : " + text

    # 메시지 설정하기
    messages = [
            {"role": "system", "content": "당신은 대화를 읽고 주어진 조건에 대해 답하여라"},
            {"role": "user", "content": query}
    ]

    # ChatGPT API 호출하기
    response = openai.ChatCompletion.create(
        model=model,
        messages=messages
    )
    answer = response['choices'][0]['message']['content']
    print(answer)



query = '''
조건1: 주어진 대화에서 상대방의 감정을 상하게 할 수 있는 발화들을 모두 찾아봐
조건2: 조건1에서 찾은 발화가 왜 문제가 있는지 이유를 알려줘
조건3: 조건2에서 찾은 이유를 고려해서, 조건1에서 찾은 모든 발화들만 개선시켜봐. 이때 미사여구는 빼고 개선된 발화만 정리해서 보여줘
'''

text = '''
speaker 0 :  뭐 니가 봤을 때 내가 살아가는 사람들이랑 문제가 크게 돼 보이나?
speaker 1 :  문제가 크게 되는 사람 이거 있잖아.
speaker 0 :  그런 부분에서만 개선을 하면 되지.
speaker 0 :  이거는 개선점이 있지만
speaker 0 :  우리 어머니 아버지처럼 가난을 물려줘야 되는 거면
speaker 0 :  그거는 개선점이 없다 본다.
speaker 1 :  가난이랑은 또 다른 문제지.
speaker 0 :  얘 봐 또 말 못 알아줬잖아.
speaker 1 :  그럼 다시 얘기해.
speaker 0 :  니 어디 뭐 교수님이야?
speaker 0 :  개선점이 있다고 했잖아.
speaker 0 :  근데 경제적인 것들은 쉽지가 않다고.
speaker 1 :  응.
speaker 0 :  뭔데 이해 똑바로 했나?
speaker 1 :  아니.
speaker 0 :  아 머리 진짜 아프다.
speaker 0 :  이해 못하는 게 내 탓이야.
speaker 0 :  내가 어려웠니 방금?
speaker 1 :  나는 평소에도 오빠 말이 어려워.
speaker 0 :  얘기를 해 봐봐.
speaker 0 :  내가 다시 설명해 줄 테니까.
speaker 1 :  가난을 되물려주지 않기 위해.
speaker 0 :  그 앞에 내가 뭐라 했는데
speaker 0 :  바로 정확하게 찍지는 못하네.
speaker 1 :  뭐라 했는데?
speaker 0 :  아니.
'''

answer(query, text)

===================================================================================================================================================================================================
결과


조건1: 
- "뭐 니가 봤을 때 내가 살아가는 사람들이랑 문제가 크게 돼 보이나?"
- "그런 부분에서만 개선을 하면 되지."
- "우리 어머니 아버지처럼 가난을 물려줘야 되는 거면"
- "얘 봐 또 말 못 알아줬잖아."
- "뭐데 이해 똑바로 했나?"
- "아머리 진짜 아프다."
- "이해 못하는 게 내 탓이야."
- "내가 어려웠니 방금?"
- "나는 평소에도 오빠 말이 어려워."
- "그 앞에 내가 뭐라 했는데 바로 정확하게 찍지는 못하네."

조건2: 
- "뭐 니가 봤을 때 내가 살아가는 사람들이랑 문제가 크게 돼 보이나?" : 이 발화는 누군가를 비판하는 발화로 상대방의 감정을 상하게 할 수 있습니다.
- "우리 어머니 아버지처럼 가난을 물려줘야 되는 거면" : 이 발화는 가난을 상대방이 물려받을 가능성이 있어 공감 대상이 될 수 있는 상황에서 사용하면 상대방의 감정을 상하게 할 수 있습니다.
- "얘 봐 또 말 못 알아줬잖아." : 이 발화는 상대방의 이해력을 조롱하는 발화로 상대방의 감정을 상하게 할 수 있습니다.
- "뭐라 했는데?" : 이 발화는 상대방의 이해력이 좋지 않다는 것을 지적하는 발화로 상대방의 감정을 상하게 할 수 있습니다.
- "아머리 진짜 아프다." : 이 발화는 상대방의 말이나 상황에 대한 불만이나 불쾌감을 표현하는 발화로 상대방의 감정을 상하게 할 수 있습니다.
- "이해 못하는 게 내 탓이야." : 이 발화는 상대방을 비난하는 발화로 상대방의 감정을 상하게 할 수 있습니다.
- "내가 어려웠니 방금?" : 이 발화는 상대방의 이해력에 대한 비난이나 의심을 불러일으키는 발화로 상대방의 감정을 상하게 할 수 있습니다.
- "나는 평소에도 오빠 말이 어려워." : 이 발화는 상대방의 말에 대한 비난이나 의심을 불러일으키는 발화로 상대방의 감정을 상하게 할 수 있습니다.
- "그 앞에 내가 뭐라 했는데 바로 정확하게 찍지는 못하네." : 이 발화는 상대방의 이해력을 비난하는 것으로 상대방의 감정을 상하게 할 수 있습니다.

조건3: 
- "뭐 니가 생각해?" -> 상대방의 의견을 존중하고 들어보는 발화
- "이 부분은 어떻게 개선할 수 있을지 생각해봤어?" -> 대화 상대방의 참여를 유도하는 발화
- "가난 문제를 개선하는 것도 중요하지만, 다른 문제도 있는 거 같아." -> 상대방의 발언을 인용하고 대화 내용에 대해서도 생각하고 있는 것을 보여주는 발화
- "어머니 아버지처럼 가난을 물려주지 않고, 더 좋은 환경에서 자라도록 도와야겠다고 생각해." -> 가난을 다루는 발화인데도, 상대방을 불편하게 하지 않으면서 상대방의 감정을 고려한 개선된 발화
- "미안해, 내가 이해시켜주지 못한 게 내 탓이었어." -> 책임을 전가하지 않고 사과하는 발화
- "내가 설명하기 어렵게 했던 거 같아. 다시 한 번 설명해볼게." -> 상대방의 이해력을 인증하지 않고 참여적이면서도 존중하는 발화

